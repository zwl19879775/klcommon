Recommended reading order:

lmathlib.c, lstrlib.c: get familiar with the external C API. Don't bother with the pattern matcher though. Just the easy functions. 
lapi.c: Check how the API is implemented internally. Only skim this to get a feeling for the code. Cross-reference to lua.h and luaconf.h as needed. 
lobject.h: tagged values and object representation. skim through this first. you'll want to keep a window with this file open all the time. 
lstate.h: state objects. ditto. 
lopcodes.h: bytecode instruction format and opcode definitions. easy. 
lvm.c: scroll down to luaV_execute, the main interpreter loop. see how all of the instructions are implemented. skip the details for now. reread later. 
ldo.c: calls, stacks, exceptions, coroutines. tough read. 
lstring.c: string interning. cute, huh? 
ltable.c: hash tables and arrays. tricky code. 
ltm.c: metamethod handling, reread all of lvm.c now. 
You may want to reread lapi.c now. 
ldebug.c: surprise waiting for you. abstract interpretation is used to find object names for tracebacks. does bytecode verification, too. 
lparser.c, lcode.c: recursive descent parser, targetting a register-based VM. start from chunk() and work your way through. read the expression parser and the code generator parts last. 
lgc.c: incremental garbage collector. take your time. 
Read all the other files as you see references to them. Don't let your stack get too deep though. 
If you're done before X-Mas and understood all of it, you're good. The information density of the code is rather high.

-------------------------------------------------------------------------------
global_State是一个全局的state，被多个lua_State共享。

index2adr函数将一个整数栈索引转换为栈元素指针，这里的栈元素都是TValue类型；
lua_State::base对应于栈底，lua_State::top对应于栈顶。

api_check宏基本就是个简单的assert。

api_incr_top宏用于增加栈空间: t->top++。

lua_atpanic用于设置一个异常处理回调函数，仅仅于luaD_throw中调用，调用后紧接着
exit代码。

TValue是栈元素类型，它是一个典型的value-type的结构体。

lua_pushXXX系列的函数都是直接往lua_State::top写一个TValue，然后top增长。




